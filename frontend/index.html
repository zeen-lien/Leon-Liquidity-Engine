<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Leon Liquidity Engine - Cyberpunk Trading</title>
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;500;600;700;800;900&family=Rajdhani:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  <style>
    :root {
      --bg-void: #000000;
      --bg-deep: #020202;
      --bg-panel: transparent;
      --bg-card: rgba(0, 0, 0, 0.3);
      --bg-hover: rgba(255, 255, 255, 0.03);
      
      /* NEON COLORS - BRIGHT & VIBRANT */
      --neon-red: #ff073a;
      --neon-orange: #ff6b00;
      --neon-yellow: #ffe600;
      --neon-lime: #39ff14;
      --neon-cyan: #00fff7;
      --neon-blue: #0080ff;
      --neon-pink: #ff1493;
      --neon-white: #ffffff;
      
      /* CRYPTO SPECIFIC COLORS */
      --btc-color: #ff9500;
      --eth-color: #00d4ff;
      --bnb-color: #f0b90b;
      --sol-color: #14f195;
      --xrp-color: #00aae4;
      --doge-color: #c3a634;
      --ada-color: #0033ad;
      --avax-color: #e84142;
      --dot-color: #e6007a;
      --matic-color: #8247e5;
      
      --glow-red: 0 0 20px rgba(255, 7, 58, 0.6), 0 0 40px rgba(255, 7, 58, 0.3);
      --glow-orange: 0 0 20px rgba(255, 107, 0, 0.6), 0 0 40px rgba(255, 107, 0, 0.3);
      --glow-yellow: 0 0 20px rgba(255, 230, 0, 0.6), 0 0 40px rgba(255, 230, 0, 0.3);
      --glow-lime: 0 0 20px rgba(57, 255, 20, 0.6), 0 0 40px rgba(57, 255, 20, 0.3);
      --glow-cyan: 0 0 20px rgba(0, 255, 247, 0.6), 0 0 40px rgba(0, 255, 247, 0.3);
      --glow-blue: 0 0 20px rgba(0, 128, 255, 0.6), 0 0 40px rgba(0, 128, 255, 0.3);
      --glow-pink: 0 0 20px rgba(255, 20, 147, 0.6), 0 0 40px rgba(255, 20, 147, 0.3);
      
      --text-primary: #ffffff;
      --text-secondary: #b0b0b0;
      --text-muted: #606060;
      
      --border-neon: rgba(255, 7, 58, 0.4);
      --gradient-fire: linear-gradient(135deg, var(--neon-red), var(--neon-orange), var(--neon-yellow));
      --gradient-ice: linear-gradient(135deg, var(--neon-cyan), var(--neon-blue));
      --gradient-toxic: linear-gradient(135deg, var(--neon-lime), var(--neon-yellow));
    }

    * { box-sizing: border-box; margin: 0; padding: 0; }
    
    body {
      font-family: 'Rajdhani', sans-serif;
      background: var(--bg-void);
      color: var(--text-primary);
      min-height: 100vh;
      display: flex;
      overflow-x: hidden;
    }

    /* Animated Background - Subtle */
    body::before {
      content: '';
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: 
        radial-gradient(ellipse at 10% 10%, rgba(255, 7, 58, 0.05) 0%, transparent 40%),
        radial-gradient(ellipse at 90% 90%, rgba(0, 255, 247, 0.05) 0%, transparent 40%),
        radial-gradient(ellipse at 50% 50%, rgba(255, 230, 0, 0.03) 0%, transparent 50%);
      pointer-events: none;
      z-index: 0;
    }

    /* Grid Lines - Red tint */
    body::after {
      content: '';
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-image: 
        linear-gradient(rgba(255, 7, 58, 0.03) 1px, transparent 1px),
        linear-gradient(90deg, rgba(255, 7, 58, 0.03) 1px, transparent 1px);
      background-size: 60px 60px;
      pointer-events: none;
      z-index: 0;
    }

    /* ============ SCROLLBAR - FIRE THEME ============ */
    ::-webkit-scrollbar { width: 6px; height: 6px; }
    ::-webkit-scrollbar-track { background: #000; }
    ::-webkit-scrollbar-thumb { 
      background: linear-gradient(180deg, var(--neon-red), var(--neon-orange));
      border-radius: 3px;
    }
    ::-webkit-scrollbar-thumb:hover { 
      box-shadow: var(--glow-red);
    }

    /* ============ SIDEBAR ============ */
    .sidebar {
      width: 260px;
      background: transparent;
      border-right: 1px solid rgba(255, 7, 58, 0.3);
      padding: 20px 16px;
      display: flex;
      flex-direction: column;
      position: fixed;
      height: 100vh;
      z-index: 100;
      transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .sidebar::before {
      content: '';
      position: absolute;
      top: 0;
      right: 0;
      width: 2px;
      height: 100%;
      background: linear-gradient(180deg, var(--neon-red), var(--neon-orange), var(--neon-yellow));
    }

    /* Logo */
    .logo {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 16px;
      margin-bottom: 32px;
      background: transparent;
      border: 1px solid rgba(255, 7, 58, 0.4);
      border-radius: 12px;
      position: relative;
    }

    .logo-icon {
      width: 44px;
      height: 44px;
      background: var(--gradient-fire);
      border-radius: 10px;
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: var(--glow-red);
    }

    .logo-icon svg {
      width: 24px;
      height: 24px;
      fill: none;
      stroke: #000;
      stroke-width: 2;
    }

    .logo-text {
      position: relative;
      z-index: 1;
    }

    .logo-title {
      font-family: 'Orbitron', sans-serif;
      font-size: 16px;
      font-weight: 700;
      background: var(--gradient-fire);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }

    .logo-subtitle {
      font-size: 10px;
      color: var(--neon-orange);
      letter-spacing: 2px;
      text-transform: uppercase;
    }

    /* Navigation */
    .nav-section {
      margin-bottom: 24px;
    }

    .nav-label {
      font-family: 'Orbitron', sans-serif;
      font-size: 9px;
      text-transform: uppercase;
      letter-spacing: 2px;
      color: var(--neon-red);
      padding: 0 12px;
      margin-bottom: 12px;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .nav-label::after {
      content: '';
      flex: 1;
      height: 1px;
      background: linear-gradient(90deg, var(--neon-red), transparent);
    }

    .nav-btn {
      width: 100%;
      padding: 12px 16px;
      background: transparent;
      border: 1px solid transparent;
      border-radius: 8px;
      color: var(--text-secondary);
      font-family: 'Rajdhani', sans-serif;
      font-size: 14px;
      font-weight: 500;
      text-align: left;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 12px;
      transition: all 0.3s ease;
      margin-bottom: 4px;
      position: relative;
    }

    .nav-btn::before {
      content: '';
      position: absolute;
      left: 0;
      top: 0;
      width: 3px;
      height: 100%;
      background: var(--gradient-fire);
      transform: scaleY(0);
      transition: transform 0.3s ease;
    }

    .nav-btn:hover {
      background: rgba(255, 7, 58, 0.1);
      border-color: rgba(255, 7, 58, 0.4);
      color: var(--neon-red);
    }

    .nav-btn:hover::before {
      transform: scaleY(1);
    }

    .nav-btn.active {
      background: rgba(255, 7, 58, 0.15);
      border-color: var(--neon-red);
      color: var(--neon-orange);
    }

    .nav-btn.active::before {
      transform: scaleY(1);
    }

    .nav-btn svg {
      width: 20px;
      height: 20px;
      stroke: currentColor;
      fill: none;
      stroke-width: 1.5;
      transition: all 0.3s ease;
    }

    .nav-btn:hover svg,
    .nav-btn.active svg {
      filter: drop-shadow(0 0 8px currentColor);
    }

    /* Sidebar Footer */
    .sidebar-footer {
      margin-top: auto;
      padding: 16px;
      background: rgba(0, 240, 255, 0.03);
      border: 1px solid rgba(0, 240, 255, 0.1);
      border-radius: 8px;
    }

    .status-indicator {
      display: flex;
      align-items: center;
      gap: 8px;
      margin-bottom: 8px;
    }

    .status-dot {
      width: 8px;
      height: 8px;
      border-radius: 50%;
      background: var(--neon-lime);
      box-shadow: 0 0 10px var(--neon-lime), 0 0 20px var(--neon-lime);
      animation: statusPulse 1.5s ease-in-out infinite;
    }

    @keyframes statusPulse {
      0%, 100% { opacity: 1; transform: scale(1); }
      50% { opacity: 0.7; transform: scale(1.2); }
    }

    .status-text {
      font-size: 11px;
      color: var(--neon-lime);
      font-weight: 600;
    }

    .version-text {
      font-size: 10px;
      color: var(--text-muted);
      font-family: 'Orbitron', sans-serif;
    }

    /* ============ MAIN CONTENT ============ */
    .main {
      flex: 1;
      margin-left: 260px;
      padding: 28px;
      min-height: 100vh;
      position: relative;
      z-index: 1;
      transition: margin-left 0.4s ease;
    }

    .page { display: none; }
    .page.active { display: block; animation: pageIn 0.5s ease; }

    @keyframes pageIn {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }

    /* Page Header */
    .page-header {
      margin-bottom: 28px;
    }

    .page-title {
      font-family: 'Orbitron', sans-serif;
      font-size: 28px;
      font-weight: 700;
      background: var(--gradient-fire);
      -webkit-background-clip: text;
      background-clip: text;
      -webkit-text-fill-color: transparent;
      margin-bottom: 8px;
    }

    .page-subtitle {
      font-size: 14px;
      color: var(--text-secondary);
    }
</style>
</head>
<body>
  <div class="overlay" id="overlay" onclick="toggleSidebar()"></div>

  <!-- Sidebar -->
  <aside class="sidebar" id="sidebar">
    <div class="logo">
      <div class="logo-icon">
        <svg viewBox="0 0 24 24"><path d="M13 2L3 14h9l-1 8 10-12h-9l1-8z"/></svg>
      </div>
      <div class="logo-text">
        <div class="logo-title">LEON ENGINE</div>
        <div class="logo-subtitle">Liquidity Protocol</div>
      </div>
    </div>

    <nav class="nav-section">
      <div class="nav-label">Live Trading</div>
      <button class="nav-btn active" onclick="showPage('dashboard')">
        <svg viewBox="0 0 24 24"><rect x="3" y="3" width="7" height="7" rx="1"/><rect x="14" y="3" width="7" height="7" rx="1"/><rect x="14" y="14" width="7" height="7" rx="1"/><rect x="3" y="14" width="7" height="7" rx="1"/></svg>
        <span>Dashboard</span>
      </button>
      <button class="nav-btn" onclick="showPage('live-signals')">
        <svg viewBox="0 0 24 24"><path d="M22 12h-4l-3 9L9 3l-3 9H2"/></svg>
        <span>Live Signals</span>
      </button>
      <button class="nav-btn" onclick="showPage('ai-prediction')">
        <svg viewBox="0 0 24 24"><circle cx="12" cy="12" r="3"/><path d="M12 2v4m0 12v4M2 12h4m12 0h4"/><path d="M4.93 4.93l2.83 2.83m8.48 8.48l2.83 2.83M4.93 19.07l2.83-2.83m8.48-8.48l2.83-2.83"/></svg>
        <span>AI Prediction</span>
      </button>
    </nav>

    <nav class="nav-section">
      <div class="nav-label">Research Lab</div>
      <button class="nav-btn" onclick="showPage('backtest')">
        <svg viewBox="0 0 24 24"><path d="M12 20V10M18 20V4M6 20v-4"/></svg>
        <span>Backtest Engine</span>
      </button>
      <button class="nav-btn" onclick="showPage('data-manager')">
        <svg viewBox="0 0 24 24"><ellipse cx="12" cy="5" rx="9" ry="3"/><path d="M21 12c0 1.66-4 3-9 3s-9-1.34-9-3"/><path d="M3 5v14c0 1.66 4 3 9 3s9-1.34 9-3V5"/></svg>
        <span>Data Manager</span>
      </button>
    </nav>

    <div class="sidebar-footer">
      <div class="status-indicator">
        <div class="status-dot"></div>
        <span class="status-text">SYSTEM ONLINE</span>
      </div>
      <div class="version-text">v2.1 CYBERPUNK</div>
    </div>
  </aside>

  <!-- Main Content -->
  <main class="main">

    <!-- ============ DASHBOARD PAGE ============ -->
    <section class="page active" id="page-dashboard">
      <div class="page-header">
        <h1 class="page-title">COMMAND CENTER</h1>
        <p class="page-subtitle">Real-time market intelligence dan trading signals</p>
      </div>

      <!-- Stats Row -->
      <div class="stats-grid">
        <div class="stat-card cyber">
          <div class="stat-icon">
            <svg viewBox="0 0 24 24"><path d="M22 12h-4l-3 9L9 3l-3 9H2"/></svg>
          </div>
          <div class="stat-content">
            <div class="stat-value" id="stat-total-signals">0</div>
            <div class="stat-label">TOTAL SIGNALS</div>
          </div>
        </div>
        <div class="stat-card cyber">
          <div class="stat-icon">
            <svg viewBox="0 0 24 24"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/><polyline points="22 4 12 14.01 9 11.01"/></svg>
          </div>
          <div class="stat-content">
            <div class="stat-value" id="stat-win-rate">0%</div>
            <div class="stat-label">WIN RATE</div>
          </div>
        </div>
        <div class="stat-card cyber">
          <div class="stat-icon">
            <svg viewBox="0 0 24 24"><path d="M12 2v20M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/></svg>
          </div>
          <div class="stat-content">
            <div class="stat-value" id="stat-avg-pnl">+0%</div>
            <div class="stat-label">AVG P&L</div>
          </div>
        </div>
        <div class="stat-card cyber">
          <div class="stat-icon">
            <svg viewBox="0 0 24 24"><circle cx="12" cy="12" r="10"/><path d="M12 6v6l4 2"/></svg>
          </div>
          <div class="stat-content">
            <div class="stat-value" id="stat-active-pairs">10</div>
            <div class="stat-label">ACTIVE PAIRS</div>
          </div>
        </div>
      </div>

      <!-- Real-time Prices -->
      <div class="card cyber-card">
        <div class="card-header">
          <div class="card-title">
            <svg viewBox="0 0 24 24"><circle cx="12" cy="12" r="10"/><path d="M12 6v6l4 2"/></svg>
            <span>REAL-TIME PRICES</span>
            <span class="badge live">LIVE</span>
          </div>
          <button class="btn-cyber" onclick="loadRealtimePrices()">
            <svg viewBox="0 0 24 24"><path d="M23 4v6h-6M1 20v-6h6"/><path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"/></svg>
            <span>REFRESH</span>
          </button>
        </div>
        <div class="price-grid" id="realtime-prices">
          <div class="loading-cyber"><div class="cyber-spinner"></div><span>LOADING MARKET DATA...</span></div>
        </div>
      </div>

      <!-- Charts Row -->
      <div class="grid-2">
        <div class="card cyber-card">
          <div class="card-header">
            <div class="card-title">
              <svg viewBox="0 0 24 24"><path d="M21.21 15.89A10 10 0 1 1 8 2.83"/><path d="M22 12A10 10 0 0 0 12 2v10z"/></svg>
              <span>DISTRIBUSI HASIL</span>
              <span class="badge">ANALYTICS</span>
            </div>
          </div>
          <div class="chart-container"><canvas id="chartPie"></canvas></div>
        </div>
        <div class="card cyber-card">
          <div class="card-header">
            <div class="card-title">
              <svg viewBox="0 0 24 24"><polyline points="23 6 13.5 15.5 8.5 10.5 1 18"/><polyline points="17 6 23 6 23 12"/></svg>
              <span>EQUITY CURVE</span>
              <span class="badge green">GROWTH</span>
            </div>
          </div>
          <div class="chart-container"><canvas id="chartEquity"></canvas></div>
        </div>
      </div>
    </section>

    <!-- ============ LIVE SIGNALS PAGE ============ -->
    <section class="page" id="page-live-signals">
      <div class="page-header">
        <h1 class="page-title">LIVE SIGNALS</h1>
        <p class="page-subtitle">Real-time trading signals dari analisis teknikal Binance API</p>
      </div>

      <div class="card cyber-card">
        <div class="card-header">
          <div class="card-title">
            <svg viewBox="0 0 24 24"><circle cx="12" cy="12" r="3"/><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"/></svg>
            <span>SIGNAL GENERATOR</span>
          </div>
        </div>
        <div class="form-grid-3">
          <div class="form-group">
            <label class="form-label">SYMBOL</label>
            <select class="form-select cyber-select" id="live-symbol">
              <option value="BTCUSDT">BTC/USDT</option>
              <option value="ETHUSDT">ETH/USDT</option>
              <option value="BNBUSDT">BNB/USDT</option>
              <option value="SOLUSDT">SOL/USDT</option>
              <option value="XRPUSDT">XRP/USDT</option>
            </select>
          </div>
          <div class="form-group">
            <label class="form-label">MODE TRADING</label>
            <select class="form-select cyber-select" id="live-mode">
              <option value="aktif">AKTIF (1-4H)</option>
              <option value="santai" selected>SANTAI (4-12H)</option>
              <option value="pasif">PASIF (12-24H)</option>
            </select>
          </div>
          <div class="form-group">
            <label class="form-label">&nbsp;</label>
            <button class="btn-cyber primary full" onclick="generateLiveSignal()">
              <svg viewBox="0 0 24 24"><path d="M22 12h-4l-3 9L9 3l-3 9H2"/></svg>
              <span>GENERATE SIGNAL</span>
            </button>
          </div>
        </div>
        <div class="info-box">
          <svg viewBox="0 0 24 24"><circle cx="12" cy="12" r="10"/><line x1="12" y1="16" x2="12" y2="12"/><line x1="12" y1="8" x2="12.01" y2="8"/></svg>
          <div>
            <strong>Live Signals</strong> menganalisis data real-time dari Binance API menggunakan indikator teknikal (RSI, EMA, ATR) untuk menghasilkan sinyal BELI/JUAL dengan Entry, Stop Loss, dan Take Profit.
          </div>
        </div>
      </div>

      <div class="card cyber-card">
        <div class="card-header">
          <div class="card-title">
            <svg viewBox="0 0 24 24"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/></svg>
            <span>SIGNAL OUTPUT</span>
          </div>
        </div>
        <div id="live-signals-table">
          <div class="empty-state">
            <svg viewBox="0 0 24 24"><path d="M22 12h-4l-3 9L9 3l-3 9H2"/></svg>
            <p>Klik GENERATE SIGNAL untuk memulai analisis</p>
          </div>
        </div>
      </div>
    </section>

    <!-- ============ AI PREDICTION PAGE ============ -->
    <section class="page" id="page-ai-prediction">
      <div class="page-header">
        <h1 class="page-title">AI PREDICTION</h1>
        <p class="page-subtitle">Deep Learning LSTM untuk prediksi arah harga cryptocurrency</p>
      </div>

      <div class="grid-2">
        <div class="card cyber-card">
          <div class="card-header">
            <div class="card-title">
              <svg viewBox="0 0 24 24"><circle cx="12" cy="12" r="3"/><path d="M12 2v4m0 12v4M2 12h4m12 0h4"/></svg>
              <span>SELECT TARGET</span>
            </div>
          </div>
          <div class="form-group">
            <label class="form-label">CRYPTOCURRENCY</label>
            <select class="form-select cyber-select large" id="ai-symbol">
              <option value="BTCUSDT">BTC/USDT - Bitcoin</option>
              <option value="ETHUSDT">ETH/USDT - Ethereum</option>
              <option value="BNBUSDT">BNB/USDT - Binance Coin</option>
              <option value="SOLUSDT">SOL/USDT - Solana</option>
              <option value="XRPUSDT">XRP/USDT - Ripple</option>
              <option value="DOGEUSDT">DOGE/USDT - Dogecoin</option>
              <option value="ADAUSDT">ADA/USDT - Cardano</option>
              <option value="AVAXUSDT">AVAX/USDT - Avalanche</option>
            </select>
          </div>
          <button class="btn-cyber primary full" onclick="getAIPrediction()">
            <svg viewBox="0 0 24 24"><circle cx="12" cy="12" r="3"/><path d="M12 2v4m0 12v4M2 12h4m12 0h4"/></svg>
            <span>ANALYZE WITH AI</span>
          </button>
          <div class="info-box" style="margin-top: 16px;">
            <svg viewBox="0 0 24 24"><circle cx="12" cy="12" r="10"/><line x1="12" y1="16" x2="12" y2="12"/><line x1="12" y1="8" x2="12.01" y2="8"/></svg>
            <div>
              <strong>AI Prediction</strong> menggunakan model LSTM (Long Short-Term Memory) untuk memprediksi arah harga (NAIK/TURUN) berdasarkan pola historis dan indikator teknikal.
            </div>
          </div>
        </div>

        <div class="card cyber-card">
          <div class="card-header">
            <div class="card-title">
              <svg viewBox="0 0 24 24"><path d="M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5"/></svg>
              <span>PREDICTION RESULT</span>
              <span class="badge purple">LSTM</span>
            </div>
          </div>
          <div id="ai-prediction-result">
            <div class="empty-state">
              <svg viewBox="0 0 24 24"><circle cx="12" cy="12" r="3"/><path d="M12 2v4m0 12v4M2 12h4m12 0h4"/></svg>
              <p>Pilih cryptocurrency dan klik ANALYZE WITH AI</p>
            </div>
          </div>
        </div>
      </div>

      <div class="card cyber-card">
        <div class="card-header">
          <div class="card-title">
            <svg viewBox="0 0 24 24"><path d="M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5"/></svg>
            <span>PERBEDAAN AI PREDICTION vs LIVE SIGNALS</span>
          </div>
        </div>
        <div class="comparison-grid">
          <div class="comparison-card ai">
            <div class="comparison-header">
              <svg viewBox="0 0 24 24"><circle cx="12" cy="12" r="3"/><path d="M12 2v4m0 12v4M2 12h4m12 0h4"/></svg>
              <span>AI PREDICTION</span>
            </div>
            <ul class="comparison-list">
              <li>Menggunakan Deep Learning (LSTM Neural Network)</li>
              <li>Memprediksi ARAH harga: NAIK atau TURUN</li>
              <li>Output: Direction + Confidence Score</li>
              <li>Cocok untuk analisis jangka menengah-panjang</li>
              <li>Belajar dari pola historis kompleks</li>
            </ul>
          </div>
          <div class="comparison-card live">
            <div class="comparison-header">
              <svg viewBox="0 0 24 24"><path d="M22 12h-4l-3 9L9 3l-3 9H2"/></svg>
              <span>LIVE SIGNALS</span>
            </div>
            <ul class="comparison-list">
              <li>Menggunakan Indikator Teknikal (RSI, EMA, ATR)</li>
              <li>Menghasilkan SINYAL trading: BELI atau JUAL</li>
              <li>Output: Entry, Stop Loss, Take Profit, Confidence</li>
              <li>Cocok untuk trading aktif dengan target jelas</li>
              <li>Berbasis rules dan confluence indicators</li>
            </ul>
          </div>
        </div>
      </div>
    </section>

    <!-- ============ BACKTEST PAGE ============ -->
    <section class="page" id="page-backtest">
      <div class="page-header">
        <h1 class="page-title">BACKTEST ENGINE</h1>
        <p class="page-subtitle">Test strategi trading dengan data historis CSV</p>
      </div>

      <div class="grid-2">
        <div class="card cyber-card">
          <div class="card-header">
            <div class="card-title">
              <svg viewBox="0 0 24 24"><polygon points="5 3 19 12 5 21 5 3"/></svg>
              <span>RUN BACKTEST</span>
            </div>
          </div>
          <div class="form-group">
            <label class="form-label">DATA FOLDER</label>
            <select class="form-select cyber-select" id="backtest-folder">
              <option value="">-- SELECT FOLDER --</option>
            </select>
          </div>
          <div class="form-group">
            <label class="form-label">TRADING MODE</label>
            <select class="form-select cyber-select" id="backtest-mode">
              <option value="aktif">AKTIF - RSI 6, EMA 9/20/50</option>
              <option value="santai" selected>SANTAI - RSI 8, EMA 20/50/200</option>
              <option value="pasif">PASIF - RSI 14, EMA 50/100/200</option>
            </select>
          </div>
          <button class="btn-cyber primary full" onclick="runBacktest()">
            <svg viewBox="0 0 24 24"><polygon points="5 3 19 12 5 21 5 3"/></svg>
            <span>EXECUTE BACKTEST</span>
          </button>
        </div>

        <div class="card cyber-card">
          <div class="card-header">
            <div class="card-title">
              <svg viewBox="0 0 24 24"><path d="M12 20V10M18 20V4M6 20v-4"/></svg>
              <span>PERFORMANCE METRICS</span>
            </div>
          </div>
          <div class="stats-mini-grid">
            <div class="stat-mini">
              <div class="stat-mini-value" id="bt-total">0</div>
              <div class="stat-mini-label">SIGNALS</div>
            </div>
            <div class="stat-mini green">
              <div class="stat-mini-value" id="bt-winrate">0%</div>
              <div class="stat-mini-label">WIN RATE</div>
            </div>
            <div class="stat-mini cyan">
              <div class="stat-mini-value" id="bt-tp">0</div>
              <div class="stat-mini-label">HIT TP</div>
            </div>
            <div class="stat-mini red">
              <div class="stat-mini-value" id="bt-sl">0</div>
              <div class="stat-mini-label">HIT SL</div>
            </div>
          </div>
        </div>
      </div>

      <div class="card cyber-card">
        <div class="card-header">
          <div class="card-title">
            <svg viewBox="0 0 24 24"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/></svg>
            <span>BACKTEST RESULTS</span>
          </div>
        </div>
        <div id="backtest-results">
          <div class="empty-state">
            <svg viewBox="0 0 24 24"><path d="M12 20V10M18 20V4M6 20v-4"/></svg>
            <p>Select folder dan klik EXECUTE BACKTEST</p>
          </div>
        </div>
      </div>
    </section>

    <!-- ============ DATA MANAGER PAGE ============ -->
    <section class="page" id="page-data-manager">
      <div class="page-header">
        <h1 class="page-title">DATA MANAGER</h1>
        <p class="page-subtitle">Upload dan kelola data CSV untuk backtest</p>
      </div>

      <div class="grid-2">
        <div class="card cyber-card">
          <div class="card-header">
            <div class="card-title">
              <svg viewBox="0 0 24 24"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="17 8 12 3 7 8"/><line x1="12" y1="3" x2="12" y2="15"/></svg>
              <span>UPLOAD CSV</span>
            </div>
          </div>
          <div class="form-group">
            <label class="form-label">TARGET FOLDER</label>
            <div class="input-group">
              <select class="form-select cyber-select" id="upload-folder">
                <option value="">-- SELECT FOLDER --</option>
              </select>
              <button class="btn-cyber" onclick="createFolder()">
                <svg viewBox="0 0 24 24"><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></svg>
              </button>
            </div>
          </div>
          <div class="form-group">
            <label class="form-label">CSV FILE</label>
            <div class="file-input-wrapper">
              <input type="file" id="upload-file" accept=".csv" onchange="updateFileName(this)" />
              <div class="file-input-display">
                <span class="file-btn">BROWSE</span>
                <span class="file-name" id="file-name-display">No file selected</span>
              </div>
            </div>
          </div>
          <button class="btn-cyber primary full" onclick="uploadCSV()">
            <svg viewBox="0 0 24 24"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="17 8 12 3 7 8"/><line x1="12" y1="3" x2="12" y2="15"/></svg>
            <span>UPLOAD FILE</span>
          </button>
        </div>

        <div class="card cyber-card">
          <div class="card-header">
            <div class="card-title">
              <svg viewBox="0 0 24 24"><circle cx="12" cy="12" r="3"/><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"/></svg>
              <span>PROCESS DATA</span>
            </div>
          </div>
          <div class="form-group">
            <label class="form-label">SELECT FOLDER</label>
            <select class="form-select cyber-select" id="process-folder">
              <option value="">-- SELECT FOLDER --</option>
            </select>
          </div>
          <button class="btn-cyber primary full" onclick="processData()">
            <svg viewBox="0 0 24 24"><circle cx="12" cy="12" r="3"/><path d="M12 2v4m0 12v4M2 12h4m12 0h4"/></svg>
            <span>PROCESS INDICATORS</span>
          </button>
          <div class="info-box" style="margin-top: 16px;">
            <svg viewBox="0 0 24 24"><circle cx="12" cy="12" r="10"/><line x1="12" y1="16" x2="12" y2="12"/><line x1="12" y1="8" x2="12.01" y2="8"/></svg>
            <div>Proses akan menambahkan indikator RSI, EMA, dan ATR ke data CSV.</div>
          </div>
        </div>
      </div>

      <div class="card cyber-card">
        <div class="card-header">
          <div class="card-title">
            <svg viewBox="0 0 24 24"><path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"/></svg>
            <span>DATA FOLDERS</span>
          </div>
          <button class="btn-cyber" onclick="loadFolders()">
            <svg viewBox="0 0 24 24"><path d="M23 4v6h-6M1 20v-6h6"/><path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"/></svg>
            <span>REFRESH</span>
          </button>
        </div>
        <div id="folder-list">
          <div class="loading-cyber"><div class="cyber-spinner"></div><span>SCANNING FOLDERS...</span></div>
        </div>
      </div>
    </section>
  </main>

  <!-- Mobile Nav Button -->
  <button class="mobile-nav-btn" id="mobileNavBtn" onclick="toggleSidebar()">
    <svg viewBox="0 0 24 24"><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="18" x2="21" y2="18"/></svg>
  </button>


  <style>
    /* ============ CARDS & PANELS ============ */
    .card { margin-bottom: 20px; }
    
    .cyber-card {
      background: transparent;
      border: 1px solid rgba(255, 107, 0, 0.4);
      border-radius: 12px;
      padding: 24px;
      position: relative;
      transition: all 0.3s ease;
    }

    .cyber-card:hover {
      border-color: var(--neon-orange);
      box-shadow: 0 0 25px rgba(255, 107, 0, 0.2);
    }

    .card-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 20px;
      padding-bottom: 16px;
      border-bottom: 1px solid rgba(255, 107, 0, 0.2);
    }

    .card-title {
      font-family: 'Orbitron', sans-serif;
      font-size: 13px;
      font-weight: 600;
      color: var(--neon-yellow);
      display: flex;
      align-items: center;
      gap: 10px;
      letter-spacing: 1px;
    }

    .card-title svg {
      width: 18px;
      height: 18px;
      stroke: var(--neon-orange);
      fill: none;
      stroke-width: 1.5;
    }

    .badge {
      font-family: 'Orbitron', sans-serif;
      font-size: 8px;
      padding: 4px 10px;
      border-radius: 4px;
      background: transparent;
      color: var(--neon-cyan);
      border: 1px solid var(--neon-cyan);
      text-transform: uppercase;
      letter-spacing: 1px;
    }

    .badge.live {
      background: transparent;
      color: var(--neon-lime);
      border-color: var(--neon-lime);
      box-shadow: 0 0 10px rgba(57, 255, 20, 0.5);
    }

    .badge.green { color: var(--neon-lime); border-color: var(--neon-lime); }
    .badge.purple { color: var(--neon-pink); border-color: var(--neon-pink); }

    /* ============ STATS GRID ============ */
    .stats-grid {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 16px;
      margin-bottom: 24px;
    }

    .stat-card {
      background: transparent;
      border: 1px solid rgba(255, 7, 58, 0.4);
      border-radius: 12px;
      padding: 20px;
      position: relative;
      transition: all 0.3s ease;
    }

    .stat-card:hover {
      border-color: var(--neon-red);
      box-shadow: 0 0 20px rgba(255, 7, 58, 0.2);
    }

    .stat-card:nth-child(1) { border-color: rgba(255, 107, 0, 0.5); }
    .stat-card:nth-child(1):hover { border-color: var(--neon-orange); box-shadow: 0 0 20px rgba(255, 107, 0, 0.3); }
    .stat-card:nth-child(2) { border-color: rgba(57, 255, 20, 0.5); }
    .stat-card:nth-child(2):hover { border-color: var(--neon-lime); box-shadow: 0 0 20px rgba(57, 255, 20, 0.3); }
    .stat-card:nth-child(3) { border-color: rgba(0, 255, 247, 0.5); }
    .stat-card:nth-child(3):hover { border-color: var(--neon-cyan); box-shadow: 0 0 20px rgba(0, 255, 247, 0.3); }
    .stat-card:nth-child(4) { border-color: rgba(255, 20, 147, 0.5); }
    .stat-card:nth-child(4):hover { border-color: var(--neon-pink); box-shadow: 0 0 20px rgba(255, 20, 147, 0.3); }

    .stat-card .stat-icon {
      width: 40px;
      height: 40px;
      background: transparent;
      border: 1px solid currentColor;
      border-radius: 10px;
      display: flex;
      align-items: center;
      justify-content: center;
      margin-bottom: 12px;
    }

    .stat-card:nth-child(1) .stat-icon { border-color: var(--neon-orange); }
    .stat-card:nth-child(1) .stat-icon svg { stroke: var(--neon-orange); }
    .stat-card:nth-child(2) .stat-icon { border-color: var(--neon-lime); }
    .stat-card:nth-child(2) .stat-icon svg { stroke: var(--neon-lime); }
    .stat-card:nth-child(3) .stat-icon { border-color: var(--neon-cyan); }
    .stat-card:nth-child(3) .stat-icon svg { stroke: var(--neon-cyan); }
    .stat-card:nth-child(4) .stat-icon { border-color: var(--neon-pink); }
    .stat-card:nth-child(4) .stat-icon svg { stroke: var(--neon-pink); }

    .stat-card .stat-icon svg {
      width: 20px;
      height: 20px;
      fill: none;
      stroke-width: 1.5;
    }

    .stat-value {
      font-family: 'Orbitron', sans-serif;
      font-size: 28px;
      font-weight: 700;
      margin-bottom: 4px;
    }

    .stat-card:nth-child(1) .stat-value { color: var(--neon-orange); }
    .stat-card:nth-child(2) .stat-value { color: var(--neon-lime); }
    .stat-card:nth-child(3) .stat-value { color: var(--neon-cyan); }
    .stat-card:nth-child(4) .stat-value { color: var(--neon-pink); }

    .stat-label {
      font-family: 'Orbitron', sans-serif;
      font-size: 9px;
      color: var(--text-muted);
      letter-spacing: 1px;
    }

    .stat-glow {
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      height: 3px;
      background: var(--neon-orange);
      box-shadow: 0 0 20px var(--neon-orange);
    }

    .stat-glow.green { background: var(--neon-lime); box-shadow: 0 0 20px var(--neon-lime); }
    .stat-glow.cyan { background: var(--neon-cyan); box-shadow: 0 0 20px var(--neon-cyan); }
    .stat-glow.pink { background: var(--neon-pink); box-shadow: 0 0 20px var(--neon-pink); }

    /* ============ PRICE GRID ============ */
    .price-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
      gap: 12px;
    }

    .price-card {
      background: transparent;
      border: 1px solid rgba(255, 255, 255, 0.15);
      border-radius: 8px;
      padding: 14px 16px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      transition: all 0.3s ease;
    }

    .price-card:hover {
      transform: translateY(-2px);
    }

    /* Crypto-specific colors */
    .price-card[data-symbol="BTC"] { border-color: rgba(255, 149, 0, 0.5); }
    .price-card[data-symbol="BTC"]:hover { border-color: #ff9500; box-shadow: 0 0 20px rgba(255, 149, 0, 0.3); }
    .price-card[data-symbol="ETH"] { border-color: rgba(0, 212, 255, 0.5); }
    .price-card[data-symbol="ETH"]:hover { border-color: #00d4ff; box-shadow: 0 0 20px rgba(0, 212, 255, 0.3); }
    .price-card[data-symbol="BNB"] { border-color: rgba(240, 185, 11, 0.5); }
    .price-card[data-symbol="BNB"]:hover { border-color: #f0b90b; box-shadow: 0 0 20px rgba(240, 185, 11, 0.3); }
    .price-card[data-symbol="SOL"] { border-color: rgba(20, 241, 149, 0.5); }
    .price-card[data-symbol="SOL"]:hover { border-color: #14f195; box-shadow: 0 0 20px rgba(20, 241, 149, 0.3); }
    .price-card[data-symbol="XRP"] { border-color: rgba(0, 170, 228, 0.5); }
    .price-card[data-symbol="XRP"]:hover { border-color: #00aae4; box-shadow: 0 0 20px rgba(0, 170, 228, 0.3); }
    .price-card[data-symbol="DOGE"] { border-color: rgba(195, 166, 52, 0.5); }
    .price-card[data-symbol="DOGE"]:hover { border-color: #c3a634; box-shadow: 0 0 20px rgba(195, 166, 52, 0.3); }
    .price-card[data-symbol="ADA"] { border-color: rgba(0, 51, 173, 0.5); }
    .price-card[data-symbol="ADA"]:hover { border-color: #0033ad; box-shadow: 0 0 20px rgba(0, 51, 173, 0.3); }
    .price-card[data-symbol="AVAX"] { border-color: rgba(232, 65, 66, 0.5); }
    .price-card[data-symbol="AVAX"]:hover { border-color: #e84142; box-shadow: 0 0 20px rgba(232, 65, 66, 0.3); }
    .price-card[data-symbol="DOT"] { border-color: rgba(232, 0, 122, 0.5); }
    .price-card[data-symbol="DOT"]:hover { border-color: #e6007a; box-shadow: 0 0 20px rgba(232, 0, 122, 0.3); }
    .price-card[data-symbol="MATIC"] { border-color: rgba(130, 71, 229, 0.5); }
    .price-card[data-symbol="MATIC"]:hover { border-color: #8247e5; box-shadow: 0 0 20px rgba(130, 71, 229, 0.3); }

    .price-symbol {
      font-family: 'Orbitron', sans-serif;
      font-size: 12px;
      font-weight: 600;
    }

    .price-value {
      font-family: 'Orbitron', sans-serif;
      font-size: 13px;
      font-weight: 700;
    }

    /* ============ GRIDS ============ */
    .grid-2 { display: grid; grid-template-columns: repeat(2, 1fr); gap: 20px; }
    .form-grid-3 { display: grid; grid-template-columns: repeat(3, 1fr); gap: 16px; margin-bottom: 16px; }

    /* ============ BUTTONS ============ */
    .btn-cyber {
      padding: 10px 20px;
      background: transparent;
      border: 1px solid var(--neon-red);
      border-radius: 8px;
      color: var(--neon-red);
      font-family: 'Orbitron', sans-serif;
      font-size: 11px;
      font-weight: 600;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      gap: 8px;
      transition: all 0.3s ease;
      letter-spacing: 1px;
    }

    .btn-cyber:hover {
      background: rgba(255, 7, 58, 0.15);
      box-shadow: var(--glow-red);
    }

    .btn-cyber svg {
      width: 16px;
      height: 16px;
      stroke: currentColor;
      fill: none;
      stroke-width: 2;
    }

    .btn-cyber.primary {
      background: transparent;
      border: 2px solid var(--neon-orange);
      color: var(--neon-orange);
    }

    .btn-cyber.primary:hover {
      background: rgba(255, 107, 0, 0.2);
      box-shadow: var(--glow-orange);
    }

    .btn-cyber.full { width: 100%; justify-content: center; }

    /* ============ FORM ELEMENTS ============ */
    .form-group { margin-bottom: 16px; }

    .form-label {
      display: block;
      font-family: 'Orbitron', sans-serif;
      font-size: 9px;
      color: var(--neon-yellow);
      margin-bottom: 8px;
      letter-spacing: 1px;
    }

    .cyber-select, .cyber-input {
      width: 100%;
      padding: 12px 16px;
      background: transparent;
      border: 1px solid rgba(255, 230, 0, 0.4);
      border-radius: 8px;
      color: var(--text-primary);
      font-family: 'Rajdhani', sans-serif;
      font-size: 14px;
      outline: none;
      transition: all 0.3s ease;
      cursor: pointer;
    }

    .cyber-select:focus, .cyber-input:focus {
      border-color: var(--neon-yellow);
      box-shadow: 0 0 15px rgba(255, 230, 0, 0.3);
    }

    .cyber-select {
      appearance: none;
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 24 24' fill='none' stroke='%23ffe600' stroke-width='2'%3E%3Cpath d='M6 9l6 6 6-6'/%3E%3C/svg%3E");
      background-repeat: no-repeat;
      background-position: right 16px center;
    }

    .cyber-select option {
      background: #0a0a0a;
      color: #ffffff;
      padding: 12px;
    }

    .cyber-select option:hover,
    .cyber-select option:checked {
      background: linear-gradient(90deg, #ff6b00, #ff073a);
      color: #ffffff;
    }

    .cyber-select.large { padding: 16px; font-size: 16px; }

    .input-group {
      display: flex;
      gap: 8px;
    }

    .input-group .cyber-select { flex: 1; }

    /* ============ FILE INPUT CUSTOM ============ */
    .file-input-wrapper {
      position: relative;
      width: 100%;
    }

    .file-input-wrapper input[type="file"] {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      opacity: 0;
      cursor: pointer;
      z-index: 2;
    }

    .file-input-display {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 10px 16px;
      background: transparent;
      border: 1px solid rgba(255, 230, 0, 0.4);
      border-radius: 8px;
      transition: all 0.3s ease;
    }

    .file-input-wrapper:hover .file-input-display {
      border-color: var(--neon-yellow);
      box-shadow: 0 0 15px rgba(255, 230, 0, 0.3);
    }

    .file-btn {
      background: transparent;
      border: 1px solid var(--neon-orange);
      border-radius: 6px;
      padding: 8px 16px;
      color: var(--neon-orange);
      font-family: 'Orbitron', sans-serif;
      font-size: 10px;
      font-weight: 600;
      letter-spacing: 1px;
      transition: all 0.3s ease;
    }

    .file-input-wrapper:hover .file-btn {
      background: rgba(255, 107, 0, 0.2);
      box-shadow: var(--glow-orange);
    }

    .file-name {
      color: var(--text-secondary);
      font-size: 13px;
      flex: 1;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }

    .file-name.has-file {
      color: var(--neon-lime);
    }

    /* ============ INFO BOX ============ */
    .info-box {
      display: flex;
      gap: 12px;
      padding: 14px 16px;
      background: transparent;
      border: 1px solid rgba(0, 255, 247, 0.3);
      border-radius: 8px;
      font-size: 12px;
      color: var(--text-secondary);
      line-height: 1.6;
    }

    .info-box svg {
      width: 20px;
      height: 20px;
      stroke: var(--neon-cyan);
      fill: none;
      stroke-width: 1.5;
      flex-shrink: 0;
      margin-top: 2px;
    }

    .info-box strong { color: var(--neon-cyan); }

    /* ============ COMPARISON GRID ============ */
    .comparison-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 20px;
    }

    .comparison-card {
      background: transparent;
      border: 1px solid rgba(255, 255, 255, 0.2);
      border-radius: 10px;
      padding: 20px;
    }

    .comparison-card.ai { border-color: rgba(255, 20, 147, 0.5); }
    .comparison-card.live { border-color: rgba(57, 255, 20, 0.5); }

    .comparison-header {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-bottom: 16px;
      padding-bottom: 12px;
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
      font-family: 'Orbitron', sans-serif;
      font-size: 12px;
      font-weight: 600;
    }

    .comparison-card.ai .comparison-header { color: var(--neon-pink); }
    .comparison-card.ai .comparison-header svg { stroke: var(--neon-pink); }
    .comparison-card.live .comparison-header { color: var(--neon-lime); }
    .comparison-card.live .comparison-header svg { stroke: var(--neon-lime); }

    .comparison-header svg {
      width: 20px;
      height: 20px;
      fill: none;
      stroke-width: 1.5;
    }

    .comparison-list {
      list-style: none;
      font-size: 12px;
      color: var(--text-secondary);
      line-height: 1.8;
    }

    .comparison-list li {
      padding-left: 20px;
      position: relative;
    }

    .comparison-list li::before {
      content: 'â–¸';
      position: absolute;
      left: 0;
      color: var(--neon-cyan);
    }

    .comparison-card.ai .comparison-list li::before { color: var(--neon-pink); }
    .comparison-card.live .comparison-list li::before { color: var(--neon-lime); }

    /* ============ STATS MINI GRID ============ */
    .stats-mini-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 12px;
    }

    .stat-mini {
      background: rgba(0, 240, 255, 0.05);
      border: 1px solid rgba(0, 240, 255, 0.2);
      border-radius: 8px;
      padding: 16px;
      text-align: center;
    }

    .stat-mini.green { border-color: rgba(0, 255, 136, 0.3); }
    .stat-mini.cyan { border-color: rgba(0, 240, 255, 0.3); }
    .stat-mini.red { border-color: rgba(255, 0, 68, 0.3); }

    .stat-mini-value {
      font-family: 'Orbitron', sans-serif;
      font-size: 24px;
      font-weight: 700;
      color: var(--neon-cyan);
    }

    .stat-mini.green .stat-mini-value { color: var(--neon-lime); }
    .stat-mini.red .stat-mini-value { color: var(--neon-red); }

    .stat-mini-label {
      font-family: 'Orbitron', sans-serif;
      font-size: 8px;
      color: var(--text-muted);
      letter-spacing: 1px;
      margin-top: 4px;
    }

    /* ============ CHART CONTAINER ============ */
    .chart-container {
      position: relative;
      height: 220px;
    }

    /* ============ LOADING & EMPTY STATES ============ */
    .loading-cyber {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      padding: 40px;
      gap: 16px;
    }

    .cyber-spinner {
      width: 50px;
      height: 50px;
      position: relative;
    }

    .cyber-spinner::before,
    .cyber-spinner::after {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      border-radius: 50%;
      border: 3px solid transparent;
    }

    .cyber-spinner::before {
      border-top-color: var(--neon-red);
      border-right-color: var(--neon-orange);
      animation: spinGlow 1s linear infinite;
      filter: drop-shadow(0 0 8px var(--neon-red));
    }

    .cyber-spinner::after {
      border-bottom-color: var(--neon-cyan);
      border-left-color: var(--neon-lime);
      animation: spinGlow 1.5s linear infinite reverse;
      filter: drop-shadow(0 0 8px var(--neon-cyan));
    }

    @keyframes spinGlow {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    .loading-cyber span {
      font-family: 'Orbitron', sans-serif;
      font-size: 11px;
      color: var(--neon-cyan);
      letter-spacing: 3px;
      text-shadow: 0 0 10px var(--neon-cyan);
      animation: textPulse 1.5s ease-in-out infinite;
    }

    @keyframes textPulse {
      0%, 100% { opacity: 1; text-shadow: 0 0 10px var(--neon-cyan); }
      50% { opacity: 0.6; text-shadow: 0 0 20px var(--neon-cyan), 0 0 30px var(--neon-cyan); }
    }

    @keyframes dotPulse {
      0%, 80%, 100% { transform: scale(0.6); opacity: 0.5; }
      40% { transform: scale(1.2); opacity: 1; box-shadow: 0 0 15px currentColor; }
    }

    /* ============ SWEETALERT2 CYBERPUNK THEME ============ */
    .swal2-popup {
      background: linear-gradient(135deg, rgba(0, 0, 0, 0.95), rgba(10, 10, 20, 0.98)) !important;
      border: 2px solid var(--neon-cyan) !important;
      border-radius: 16px !important;
      box-shadow: 0 0 30px rgba(0, 255, 247, 0.3), inset 0 0 60px rgba(0, 255, 247, 0.05) !important;
    }

    .swal2-title {
      font-family: 'Orbitron', sans-serif !important;
      color: var(--neon-cyan) !important;
      text-shadow: 0 0 20px var(--neon-cyan) !important;
      letter-spacing: 2px !important;
    }

    .swal2-html-container {
      color: var(--text-secondary) !important;
    }

    .swal2-input, .swal2-textarea, .swal2-select {
      background: transparent !important;
      border: 2px solid var(--neon-yellow) !important;
      border-radius: 8px !important;
      color: #fff !important;
      font-family: 'Rajdhani', sans-serif !important;
      font-size: 14px !important;
      box-shadow: 0 0 15px rgba(255, 230, 0, 0.2) !important;
    }

    .swal2-input:focus, .swal2-textarea:focus, .swal2-select:focus {
      border-color: var(--neon-orange) !important;
      box-shadow: 0 0 25px rgba(255, 107, 0, 0.4) !important;
      outline: none !important;
    }

    .swal2-input::placeholder {
      color: var(--text-muted) !important;
    }

    .swal2-confirm {
      background: transparent !important;
      border: 2px solid var(--neon-lime) !important;
      color: var(--neon-lime) !important;
      font-family: 'Orbitron', sans-serif !important;
      font-weight: 600 !important;
      letter-spacing: 1px !important;
      padding: 12px 30px !important;
      border-radius: 8px !important;
      transition: all 0.3s ease !important;
    }

    .swal2-confirm:hover {
      background: rgba(57, 255, 20, 0.2) !important;
      box-shadow: 0 0 25px rgba(57, 255, 20, 0.5) !important;
    }

    .swal2-cancel {
      background: transparent !important;
      border: 2px solid var(--neon-red) !important;
      color: var(--neon-red) !important;
      font-family: 'Orbitron', sans-serif !important;
      font-weight: 600 !important;
      letter-spacing: 1px !important;
      padding: 12px 30px !important;
      border-radius: 8px !important;
      transition: all 0.3s ease !important;
    }

    .swal2-cancel:hover {
      background: rgba(255, 7, 58, 0.2) !important;
      box-shadow: 0 0 25px rgba(255, 7, 58, 0.5) !important;
    }

    .swal2-timer-progress-bar {
      background: linear-gradient(90deg, var(--neon-red), var(--neon-orange), var(--neon-yellow)) !important;
    }

    .swal2-toast {
      background: linear-gradient(135deg, rgba(0, 0, 0, 0.95), rgba(10, 10, 20, 0.98)) !important;
      border: 1px solid var(--neon-cyan) !important;
      box-shadow: 0 0 20px rgba(0, 255, 247, 0.3) !important;
    }

    .swal2-toast .swal2-title {
      font-family: 'Rajdhani', sans-serif !important;
      font-size: 14px !important;
      letter-spacing: 1px !important;
    }

    .empty-state {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      padding: 50px;
      color: var(--text-muted);
    }

    .empty-state svg {
      width: 48px;
      height: 48px;
      stroke: var(--text-muted);
      fill: none;
      stroke-width: 1;
      margin-bottom: 16px;
      opacity: 0.5;
    }

    .empty-state p {
      font-size: 13px;
      text-align: center;
    }

    /* ============ TABLES ============ */
    .cyber-table {
      width: 100%;
      border-collapse: collapse;
    }

    .cyber-table th {
      font-family: 'Orbitron', sans-serif;
      font-size: 9px;
      color: var(--neon-cyan);
      text-align: left;
      padding: 12px 16px;
      border-bottom: 1px solid rgba(0, 240, 255, 0.2);
      letter-spacing: 1px;
    }

    .cyber-table td {
      padding: 14px 16px;
      border-bottom: 1px solid rgba(255, 255, 255, 0.05);
      font-size: 13px;
    }

    .cyber-table tr:hover td {
      background: rgba(0, 240, 255, 0.03);
    }

    .signal-buy { color: var(--neon-lime); font-weight: 700; text-shadow: 0 0 10px var(--neon-lime); }
    .signal-sell { color: var(--neon-red); font-weight: 700; text-shadow: 0 0 10px var(--neon-red); }

    /* ============ PREDICTION BOX ============ */
    .prediction-box {
      background: linear-gradient(135deg, rgba(191, 0, 255, 0.1), rgba(0, 240, 255, 0.1));
      border: 1px solid rgba(191, 0, 255, 0.3);
      border-radius: 12px;
      padding: 24px;
      text-align: center;
    }

    .prediction-symbol {
      font-family: 'Orbitron', sans-serif;
      font-size: 12px;
      color: var(--text-muted);
      margin-bottom: 16px;
    }

    .prediction-direction {
      font-size: 64px;
      font-weight: 800;
      margin: 16px 0;
      text-shadow: 0 0 30px currentColor;
    }

    .prediction-direction.up { color: var(--neon-green); }
    .prediction-direction.down { color: var(--neon-red); }

    .prediction-text {
      font-family: 'Orbitron', sans-serif;
      font-size: 20px;
      font-weight: 700;
      margin-bottom: 8px;
    }

    .prediction-confidence {
      font-size: 14px;
      color: var(--text-secondary);
    }

    .prediction-confidence strong {
      color: var(--neon-cyan);
    }

    .prediction-details {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 12px;
      margin-top: 20px;
    }

    .prediction-detail {
      background: rgba(0, 0, 0, 0.3);
      border-radius: 8px;
      padding: 12px;
    }

    .prediction-detail-label {
      font-size: 10px;
      color: var(--text-muted);
      margin-bottom: 4px;
    }

    .prediction-detail-value {
      font-family: 'Orbitron', sans-serif;
      font-size: 14px;
      font-weight: 600;
    }

    .prediction-indicators {
      margin-top: 16px;
      padding-top: 16px;
      border-top: 1px solid rgba(255, 255, 255, 0.1);
      display: flex;
      justify-content: center;
      gap: 16px;
      flex-wrap: wrap;
    }

    .indicator-tag {
      font-size: 10px;
      padding: 4px 10px;
      background: rgba(0, 240, 255, 0.1);
      border: 1px solid rgba(0, 240, 255, 0.3);
      border-radius: 4px;
      color: var(--neon-cyan);
    }

    /* ============ FOLDER GRID ============ */
    .folder-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
      gap: 12px;
    }

    .folder-card {
      background: rgba(0, 240, 255, 0.03);
      border: 1px solid rgba(0, 240, 255, 0.15);
      border-radius: 10px;
      padding: 20px;
      text-align: center;
      transition: all 0.3s ease;
      cursor: pointer;
    }

    .folder-card:hover {
      background: rgba(0, 240, 255, 0.08);
      border-color: var(--neon-cyan);
      transform: translateY(-4px);
      box-shadow: 0 10px 30px rgba(0, 240, 255, 0.15);
    }

    .folder-card svg {
      width: 32px;
      height: 32px;
      stroke: var(--neon-cyan);
      fill: none;
      stroke-width: 1.5;
      margin-bottom: 8px;
    }

    .folder-name {
      font-family: 'Orbitron', sans-serif;
      font-size: 12px;
      font-weight: 600;
      color: var(--text-primary);
    }

    /* ============ MOBILE NAV BUTTON ============ */
    .mobile-nav-btn {
      display: none;
      position: fixed;
      bottom: 24px;
      right: 24px;
      width: 60px;
      height: 60px;
      background: var(--gradient-fire);
      border: none;
      border-radius: 50%;
      cursor: pointer;
      z-index: 200;
      box-shadow: var(--glow-red);
      transition: all 0.3s ease;
    }

    .mobile-nav-btn:hover {
      transform: scale(1.1);
      box-shadow: 0 0 40px rgba(255, 7, 58, 0.8);
    }

    .mobile-nav-btn svg {
      width: 24px;
      height: 24px;
      stroke: #000;
      fill: none;
      stroke-width: 2.5;
    }

    .overlay {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.8);
      backdrop-filter: blur(4px);
      z-index: 90;
    }

    .overlay.active { display: block; }

    /* ============ RESPONSIVE ============ */
    @media (max-width: 1200px) {
      .stats-grid { grid-template-columns: repeat(2, 1fr); }
    }

    @media (max-width: 1024px) {
      .grid-2 { grid-template-columns: 1fr; }
      .form-grid-3 { grid-template-columns: 1fr; }
      .comparison-grid { grid-template-columns: 1fr; }
    }

    @media (max-width: 768px) {
      .sidebar {
        transform: translateX(-100%);
        width: 280px;
      }

      .sidebar.open { transform: translateX(0); }

      .main {
        margin-left: 0;
        padding: 20px 16px;
      }

      .mobile-nav-btn { display: flex; align-items: center; justify-content: center; }
      
      .stats-grid { grid-template-columns: repeat(2, 1fr); gap: 12px; }
      .stat-value { font-size: 22px; }
      
      .page-title { font-size: 22px; }
      
      .price-grid { grid-template-columns: repeat(2, 1fr); }
    }

    @media (max-width: 480px) {
      .main { padding: 16px 12px; }
      .cyber-card { padding: 16px; }
      .stats-grid { grid-template-columns: 1fr; }
      .price-grid { grid-template-columns: 1fr; }
    }
  </style>


  <script>
    // ============ SWEETALERT2 CONFIG ============
    const Toast = Swal.mixin({
      toast: true,
      position: 'top-end',
      showConfirmButton: false,
      timer: 3000,
      timerProgressBar: true,
      background: '#0a0a12',
      color: '#fff',
      iconColor: '#00f0ff',
      customClass: {
        popup: 'cyber-toast'
      }
    });

    function showSuccess(message) {
      Toast.fire({ icon: 'success', title: message, iconColor: '#00ff88' });
    }

    function showError(message) {
      Toast.fire({ icon: 'error', title: message, iconColor: '#ff0044' });
    }

    function showInfo(message) {
      Toast.fire({ icon: 'info', title: message });
    }

    function showLoading(title = 'PROCESSING...') {
      Swal.fire({
        title: title,
        html: `
          <div style="display: flex; flex-direction: column; align-items: center; gap: 20px; padding: 20px;">
            <div class="cyber-spinner"></div>
            <div style="display: flex; gap: 4px;">
              <span class="loading-dot" style="width: 8px; height: 8px; background: var(--neon-red); border-radius: 50%; animation: dotPulse 1.4s ease-in-out infinite;"></span>
              <span class="loading-dot" style="width: 8px; height: 8px; background: var(--neon-orange); border-radius: 50%; animation: dotPulse 1.4s ease-in-out 0.2s infinite;"></span>
              <span class="loading-dot" style="width: 8px; height: 8px; background: var(--neon-yellow); border-radius: 50%; animation: dotPulse 1.4s ease-in-out 0.4s infinite;"></span>
              <span class="loading-dot" style="width: 8px; height: 8px; background: var(--neon-lime); border-radius: 50%; animation: dotPulse 1.4s ease-in-out 0.6s infinite;"></span>
              <span class="loading-dot" style="width: 8px; height: 8px; background: var(--neon-cyan); border-radius: 50%; animation: dotPulse 1.4s ease-in-out 0.8s infinite;"></span>
            </div>
          </div>
        `,
        showConfirmButton: false,
        allowOutsideClick: false
      });
    }

    function hideLoading() {
      Swal.close();
    }

    // ============ NAVIGATION ============
    function showPage(pageId) {
      document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
      document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
      
      const page = document.getElementById('page-' + pageId);
      if (page) page.classList.add('active');
      
      event.target.closest('.nav-btn')?.classList.add('active');
      
      if (window.innerWidth <= 768) {
        document.getElementById('sidebar').classList.remove('open');
        document.getElementById('overlay').classList.remove('active');
      }
    }

    function toggleSidebar() {
      document.getElementById('sidebar').classList.toggle('open');
      document.getElementById('overlay').classList.toggle('active');
    }

    // ============ REAL-TIME PRICES ============
    async function loadRealtimePrices() {
      const container = document.getElementById('realtime-prices');
      container.innerHTML = '<div class="loading-cyber"><div class="cyber-spinner"></div><span>FETCHING MARKET DATA...</span></div>';
      
      try {
        const res = await fetch('/binance/prices');
        const data = await res.json();
        
        if (data.status === 'sukses' && data.data) {
          let html = '';
          data.data.forEach(item => {
            const symbol = item.symbol.replace('USDT', '');
            const price = parseFloat(item.price);
            const formatted = price >= 1 ? price.toLocaleString('en-US', {minimumFractionDigits: 2, maximumFractionDigits: 2}) : price.toFixed(6);
            const color = {'BTC':'#ff9500','ETH':'#00d4ff','BNB':'#f0b90b','SOL':'#14f195','XRP':'#00aae4','DOGE':'#ffcc00','ADA':'#ff1493','AVAX':'#e84142','DOT':'#e6007a','MATIC':'#8247e5'}[symbol]||'#fff';
            html += `<div class="price-card" style="border-color:${color}60"><span class="price-symbol" style="color:${color};text-shadow:0 0 10px ${color}">${symbol}</span><span class="price-value" style="color:${color}">$${formatted}</span></div>`;
          });
          container.innerHTML = html;
          showSuccess('Market data updated');
        }
      } catch (err) {
        container.innerHTML = `<div class="empty-state"><svg viewBox="0 0 24 24"><circle cx="12" cy="12" r="10"/><line x1="12" y1="8" x2="12" y2="12"/><line x1="12" y1="16" x2="12.01" y2="16"/></svg><p>Failed to load prices</p></div>`;
        showError('Failed to fetch market data');
      }
    }

    // ============ AI PREDICTION ============
    async function getAIPrediction() {
      const symbol = document.getElementById('ai-symbol').value;
      const container = document.getElementById('ai-prediction-result');
      container.innerHTML = '<div class="loading-cyber"><div class="cyber-spinner"></div><span>ANALYZING WITH LSTM...</span></div>';
      
      try {
        const res = await fetch(`/lstm/predict/${symbol}`);
        const data = await res.json();
        
        if (data.status === 'sukses' && data.prediksi) {
          const pred = data.prediksi;
          const dir = pred.direction;
          const conf = (pred.confidence * 100).toFixed(0);
          const price = data.harga_terkini ? parseFloat(data.harga_terkini).toLocaleString('en-US', {minimumFractionDigits: 2}) : '-';
          
          const dirClass = dir === 'UP' ? 'up' : 'down';
          const dirIcon = dir === 'UP' ? 'â†‘' : dir === 'DOWN' ? 'â†“' : 'â†’';
          const dirText = dir === 'UP' ? 'BULLISH' : dir === 'DOWN' ? 'BEARISH' : 'NEUTRAL';
          const rekom = data.rekomendasi?.aksi || (dir === 'UP' ? 'BELI' : dir === 'DOWN' ? 'JUAL' : 'TUNGGU');
          
          container.innerHTML = `
            <div class="prediction-box">
              <div class="prediction-symbol">${symbol.replace('USDT', '/USDT')}</div>
              <div class="prediction-direction ${dirClass}">${dirIcon}</div>
              <div class="prediction-text" style="color: ${dir === 'UP' ? 'var(--neon-green)' : 'var(--neon-red)'};">${dirText}</div>
              <div class="prediction-confidence">Confidence: <strong>${conf}%</strong></div>
              <div class="prediction-details">
                <div class="prediction-detail">
                  <div class="prediction-detail-label">CURRENT PRICE</div>
                  <div class="prediction-detail-value" style="color: var(--neon-green);">$${price}</div>
                </div>
                <div class="prediction-detail">
                  <div class="prediction-detail-label">RECOMMENDATION</div>
                  <div class="prediction-detail-value" style="color: ${rekom === 'BELI' ? 'var(--neon-green)' : rekom === 'JUAL' ? 'var(--neon-red)' : 'var(--neon-orange)'};">${rekom}</div>
                </div>
              </div>
              ${pred.rsi ? `
              <div class="prediction-indicators">
                <span class="indicator-tag">RSI: ${pred.rsi}</span>
                <span class="indicator-tag">EMA20: ${pred.ema_20}</span>
                <span class="indicator-tag">EMA50: ${pred.ema_50}</span>
              </div>
              ` : ''}
            </div>
          `;
          showSuccess('AI Analysis complete');
        }
      } catch (err) {
        container.innerHTML = `<div class="empty-state"><svg viewBox="0 0 24 24"><circle cx="12" cy="12" r="10"/><line x1="12" y1="8" x2="12" y2="12"/><line x1="12" y1="16" x2="12.01" y2="16"/></svg><p>Analysis failed</p></div>`;
        showError('AI Analysis failed');
      }
    }

    // ============ LIVE SIGNALS ============
    async function generateLiveSignal() {
      const symbol = document.getElementById('live-symbol').value;
      const mode = document.getElementById('live-mode').value;
      const container = document.getElementById('live-signals-table');
      container.innerHTML = '<div class="loading-cyber"><div class="cyber-spinner"></div><span>GENERATING SIGNALS...</span></div>';
      
      try {
        const res = await fetch(`/binance/analyze/${symbol}?mode_trading=${mode}`, { method: 'POST' });
        const data = await res.json();
        
        if (data.status === 'sukses') {
          let html = `
            <div class="info-box" style="margin-bottom: 16px;">
              <svg viewBox="0 0 24 24"><path d="M12 20V10M18 20V4M6 20v-4"/></svg>
              <div>
                <strong>${symbol}</strong> | RSI: ${data.indikator_terkini?.rsi_14 || '-'} | EMA20: ${data.indikator_terkini?.ema_20 || '-'} | Price: <strong style="color: var(--neon-green);">$${data.harga_terkini?.toLocaleString() || '-'}</strong>
              </div>
            </div>
          `;
          
          if (data.sinyal && data.sinyal.length > 0) {
            html += '<table class="cyber-table"><thead><tr><th>PAIR</th><th>SIGNAL</th><th>ENTRY</th><th>SL</th><th>TP</th><th>CONF</th><th>REASON</th></tr></thead><tbody>';
            data.sinyal.forEach(s => {
              html += `<tr>
                <td><strong>${s.pair || symbol}</strong></td>
                <td class="${s.tipe === 'BELI' ? 'signal-buy' : 'signal-sell'}">${s.tipe}</td>
                <td>$${s.entry?.toFixed(2) || '-'}</td>
                <td>$${s.stop_loss?.toFixed(2) || '-'}</td>
                <td>$${s.take_profit?.toFixed(2) || '-'}</td>
                <td>${s.confidence ? (s.confidence * 100).toFixed(0) + '%' : '-'}</td>
                <td style="font-size: 11px; color: var(--text-secondary);">${s.alasan || '-'}</td>
              </tr>`;
            });
            html += '</tbody></table>';
            showSuccess(`${data.sinyal.length} signals generated`);
          } else {
            html += '<div class="empty-state"><svg viewBox="0 0 24 24"><path d="M22 12h-4l-3 9L9 3l-3 9H2"/></svg><p>No signals match criteria. Try different mode or wait for better conditions.</p></div>';
            showInfo('No signals found');
          }
          container.innerHTML = html;
        }
      } catch (err) {
        container.innerHTML = `<div class="empty-state"><svg viewBox="0 0 24 24"><circle cx="12" cy="12" r="10"/><line x1="12" y1="8" x2="12" y2="12"/><line x1="12" y1="16" x2="12.01" y2="16"/></svg><p>Signal generation failed</p></div>`;
        showError('Signal generation failed');
      }
    }

    // ============ BACKTEST ============
    async function runBacktest() {
      const folder = document.getElementById('backtest-folder').value;
      const mode = document.getElementById('backtest-mode').value;
      
      if (!folder) {
        showError('Please select a folder first');
        return;
      }
      
      const container = document.getElementById('backtest-results');
      container.innerHTML = '<div class="loading-cyber"><div class="cyber-spinner"></div><span>EXECUTING BACKTEST...</span></div>';
      
      try {
        const res = await fetch('/sinyal/generate', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ folder, mode_trading: mode, confidence_minimum: 0.60 })
        });
        
        const data = await res.json();
        
        if (data.backtest_statistics) {
          const stats = data.backtest_statistics;
          document.getElementById('bt-total').textContent = stats.total_signals || 0;
          document.getElementById('bt-winrate').textContent = (stats.win_rate || 0) + '%';
          document.getElementById('bt-tp').textContent = stats.hit_tp || 0;
          document.getElementById('bt-sl').textContent = stats.hit_sl || 0;
          
          // Update dashboard stats
          document.getElementById('stat-total-signals').textContent = stats.total_signals || 0;
          document.getElementById('stat-win-rate').textContent = (stats.win_rate || 0) + '%';
          document.getElementById('stat-avg-pnl').textContent = (stats.avg_pnl > 0 ? '+' : '') + (stats.avg_pnl || 0) + '%';
        }
        
        if (data.sinyal && data.sinyal.length > 0) {
          let html = '<div style="max-height: 400px; overflow-y: auto;"><table class="cyber-table"><thead><tr><th>PAIR</th><th>TYPE</th><th>ENTRY</th><th>SL</th><th>TP</th><th>CONF</th><th>RESULT</th><th>P&L</th></tr></thead><tbody>';
          data.sinyal.forEach(s => {
            const resultColor = s.backtest_result === 'HIT_TP' ? 'var(--neon-green)' : s.backtest_result === 'HIT_SL' ? 'var(--neon-red)' : 'var(--text-muted)';
            const pnl = s.pnl_percent || 0;
            const pnlColor = pnl > 0 ? 'var(--neon-green)' : pnl < 0 ? 'var(--neon-red)' : 'var(--text-muted)';
            html += `<tr>
              <td>${s.pair || '-'}</td>
              <td class="${s.tipe === 'BELI' ? 'signal-buy' : 'signal-sell'}">${s.tipe}</td>
              <td>${s.entry?.toFixed(4) || '-'}</td>
              <td>${s.stop_loss?.toFixed(4) || '-'}</td>
              <td>${s.take_profit?.toFixed(4) || '-'}</td>
              <td>${(s.confidence * 100).toFixed(0)}%</td>
              <td style="color: ${resultColor}; font-weight: 700;">${s.backtest_result || '-'}</td>
              <td style="color: ${pnlColor}; font-weight: 600;">${pnl > 0 ? '+' : ''}${pnl.toFixed(2)}%</td>
            </tr>`;
          });
          html += '</tbody></table></div>';
          container.innerHTML = html;
          showSuccess(`Backtest complete: ${data.sinyal.length} signals`);
        } else {
          container.innerHTML = '<div class="empty-state"><svg viewBox="0 0 24 24"><path d="M12 20V10M18 20V4M6 20v-4"/></svg><p>No signals found in backtest</p></div>';
          showInfo('No signals found');
        }
      } catch (err) {
        container.innerHTML = `<div class="empty-state"><svg viewBox="0 0 24 24"><circle cx="12" cy="12" r="10"/><line x1="12" y1="8" x2="12" y2="12"/><line x1="12" y1="16" x2="12.01" y2="16"/></svg><p>Backtest failed</p></div>`;
        showError('Backtest execution failed');
      }
    }

    // ============ DATA MANAGER ============
    async function loadFolders() {
      try {
        const res = await fetch('/folder/daftar');
        const data = await res.json();
        
        const folders = data.folder || [];
        
        ['upload-folder', 'process-folder', 'backtest-folder'].forEach(id => {
          const select = document.getElementById(id);
          if (select) {
            select.innerHTML = '<option value="">-- SELECT FOLDER --</option>';
            folders.forEach(f => {
              select.innerHTML += `<option value="${f}">${f}</option>`;
            });
          }
        });
        
        const listContainer = document.getElementById('folder-list');
        if (folders.length > 0) {
          let html = '<div class="folder-grid">';
          folders.forEach(f => {
            html += `<div class="folder-card">
              <svg viewBox="0 0 24 24"><path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"/></svg>
              <div class="folder-name">${f}</div>
            </div>`;
          });
          html += '</div>';
          listContainer.innerHTML = html;
        } else {
          listContainer.innerHTML = '<div class="empty-state"><svg viewBox="0 0 24 24"><path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"/></svg><p>No folders found. Create one to start.</p></div>';
        }
      } catch (err) {
        showError('Failed to load folders');
      }
    }

    async function createFolder() {
      const { value: name } = await Swal.fire({
        title: 'CREATE NEW FOLDER',
        input: 'text',
        inputPlaceholder: 'Folder name (e.g., BTC, ETH)',
        showCancelButton: true,
        confirmButtonText: 'CREATE',
        cancelButtonText: 'CANCEL'
      });
      
      if (name) {
        try {
          const res = await fetch('/folder/buat', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ nama_folder: name })
          });
          
          if (res.ok) {
            loadFolders();
            showSuccess('Folder created successfully');
          } else {
            const err = await res.text();
            showError(err);
          }
        } catch (err) {
          showError('Failed to create folder');
        }
      }
    }

    function updateFileName(input) {
      const display = document.getElementById('file-name-display');
      if (input.files && input.files[0]) {
        display.textContent = input.files[0].name;
        display.classList.add('has-file');
      } else {
        display.textContent = 'No file selected';
        display.classList.remove('has-file');
      }
    }

    async function uploadCSV() {
      const folder = document.getElementById('upload-folder').value;
      const fileInput = document.getElementById('upload-file');
      
      if (!folder) {
        showError('Please select a folder first');
        return;
      }
      
      if (!fileInput.files[0]) {
        showError('Please select a CSV file');
        return;
      }
      
      showLoading('UPLOADING FILE...');
      
      const formData = new FormData();
      formData.append('berkas', fileInput.files[0]);
      
      try {
        const res = await fetch(`/unggah-csv/?folder=${encodeURIComponent(folder)}`, {
          method: 'POST',
          body: formData
        });
        
        hideLoading();
        
        if (res.ok) {
          const data = await res.json();
          showSuccess(`Upload complete: ${data.jumlah_baris} rows`);
          fileInput.value = '';
          document.getElementById('file-name-display').textContent = 'No file selected';
          document.getElementById('file-name-display').classList.remove('has-file');
        } else {
          const err = await res.text();
          showError(err);
        }
      } catch (err) {
        hideLoading();
        showError('Upload failed');
      }
    }

    async function processData() {
      const folder = document.getElementById('process-folder').value;
      
      if (!folder) {
        showError('Please select a folder first');
        return;
      }
      
      showLoading('PROCESSING INDICATORS...');
      
      try {
        const res = await fetch('/pra-proses/indikator/', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ folder })
        });
        
        hideLoading();
        
        if (res.ok) {
          const data = await res.json();
          showSuccess(`Processed ${data.jumlah_berkas} files`);
        } else {
          const err = await res.text();
          showError(err);
        }
      } catch (err) {
        hideLoading();
        showError('Processing failed');
      }
    }

    // ============ CHARTS ============
    let chartPie = null;
    let chartEquity = null;

    function initCharts() {
      const ctxPie = document.getElementById('chartPie');
      if (ctxPie) {
        chartPie = new Chart(ctxPie, {
          type: 'doughnut',
          data: {
            labels: ['HIT TP', 'HIT SL', 'TIMEOUT'],
            datasets: [{
              data: [65, 25, 10],
              backgroundColor: ['rgba(57, 255, 20, 0.85)', 'rgba(255, 7, 58, 0.85)', 'rgba(255, 230, 0, 0.85)'],
              borderColor: ['#39ff14', '#ff073a', '#ffe600'],
              borderWidth: 3,
              hoverBorderWidth: 4
            }]
          },
          options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
              legend: {
                position: 'bottom',
                labels: { color: '#ffffff', font: { family: 'Orbitron', size: 10 }, padding: 16 }
              }
            }
          }
        });
      }

      const ctxEquity = document.getElementById('chartEquity');
      if (ctxEquity) {
        const labels = ['Start', 'T1', 'T2', 'T3', 'T4', 'T5', 'T6', 'T7', 'T8', 'T9', 'T10'];
        const data = [10000, 10250, 10100, 10400, 10350, 10600, 10550, 10800, 11000, 10900, 11200];
        
        chartEquity = new Chart(ctxEquity, {
          type: 'line',
          data: {
            labels: labels,
            datasets: [{
              label: 'Equity',
              data: data,
              borderColor: '#00fff7',
              backgroundColor: 'rgba(0, 255, 247, 0.1)',
              fill: true,
              tension: 0.4,
              pointRadius: 4,
              pointBackgroundColor: '#00fff7',
              pointBorderColor: '#000',
              pointBorderWidth: 2,
              borderWidth: 3
            }]
          },
          options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: { legend: { display: false } },
            scales: {
              x: { grid: { color: 'rgba(255, 7, 58, 0.1)' }, ticks: { color: '#ff9500', font: { family: 'Orbitron', size: 9 } } },
              y: { grid: { color: 'rgba(255, 7, 58, 0.1)' }, ticks: { color: '#ff9500', font: { family: 'Orbitron', size: 9 } } }
            }
          }
        });
      }
    }

    // ============ INIT ============
    document.addEventListener('DOMContentLoaded', () => {
      loadRealtimePrices();
      loadFolders();
      initCharts();
      
      const stats = JSON.parse(localStorage.getItem('backtestStatistics') || '{}');
      if (stats.total_signals) {
        document.getElementById('stat-total-signals').textContent = stats.total_signals;
        document.getElementById('stat-win-rate').textContent = stats.win_rate + '%';
        document.getElementById('stat-avg-pnl').textContent = (stats.avg_pnl > 0 ? '+' : '') + stats.avg_pnl + '%';
      }
    });
  </script>
</body>
</html>
